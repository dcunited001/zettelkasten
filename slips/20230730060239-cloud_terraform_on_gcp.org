:PROPERTIES:
:ID:       4ea74826-8caf-47d0-bb40-f23e27359d07
:END:
#+TITLE: Cloud: Terraform On GCP
#+CATEGORY: slips
#+TAGS:

* Docs

* Resources

* Notes

** Pricing

*** Tiers

+ TF Enterprise is basically equivalent to the TF Cloud Business Tier

|                      | TF Open Source            | TF Cloud | TF Enterprise |
|----------------------+---------------------------+----------+---------------|
| License/Cost         | none                      | 3 tiers  | $$$$          |
| Managed              | No                        | Yes      | Money Talks   |
| Hosting              | Local Machine or Cloud VM | SaaS     | On-Prem       |
| Concurrent Deploys   | No                        | Yes      | Yes           |
| GUI                  | CLI Only                  | Yes      | Yes           |
| Operational Overhead | The sky is the limit      | Light    | Heavy         |



** Concepts

+ Manage infrastructure
+ Track changes
+ Automate changes
+ Standardize configurations

*** Provisioning vs Configuration

The concepts are blurred and aren't simple to discriminate. In networking
contexts, whether signaling to routers or GCP network device objects,
provisioning may include sending a subset of network state sufficient to
complete the configuration. Sometimes, you may consider this configuration
management, but the two are not separated from each other in semantics or in
your processes/code. This convolutes your projects and processes.

+ Provisioning :: signaling to VM hosts, cloud API's, network controllers or
  rack controllers to manage objects.

  In the cloud, the API provides an interface with rules/logic. You signal to it
  and on the backend it prepares the cloud provider state. You receive signals
  from it in response and proceed with provisioning. On bare metal, this would
  involve some cfg mgmt.

+ Config management :: distributing configuration/state to entities on the
  network, usually internal to those entities. e.g. cloud-config or ssh keys or
  network device configuration.

*** Stages

| write   |   |
| init    |   |
| plan    |   |
| apply   |   |
| destroy |   |

*** Running Terraform

+ TF itself doesn't require authentication, only the provider.
+ TF on Cloud Shell: preauthenticated, but still needs roles assigned to do
  anything useful.
+ TF on a workstation: requires =gcloud auth application-default= to authenticate
+ TF on a VM: configure Google Service Accounts
+ TF outside GCP: use workload identiy fedration, generate short-lived SA key
  and set env variables. SA key rotation not allowed.

* Roam
+ [[id:8a6898ca-2c09-47aa-9a34-a74a78f6f823][Cloud]]
+ [[id:ac2a1ae4-a695-4226-91f0-8386dc4d9b07][DevOps]]
