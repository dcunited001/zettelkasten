:PROPERTIES:
:ID:       3f14aae1-e106-40a3-aff2-947d51da3c9b
:END:
#+title: Make an XKB Keyboard
#+filetags: xkb xorg linux

+ [[id:b82627bf-a0de-45c5-8ff4-229936549942][Guix]]

* Overview
+ potentially extend from German [[https://en.wikipedia.org/wiki/Neo_(keyboard_layout)#Platforms][Neo keyboard]]
+ check out [[https://github.com/kmonad/kmonad][kmonad/kmonad]]

* Resources
+ Main topic: [[id:8c6d7cdd-74af-4307-b1df-8641752a1c9f][Xorg]]

* Custom Keyboards in Guix

More convoluted than it should have to be, but potentially the [first] last time
I'd ever have to do it.

** Extend =xkeyboard-config=

This should either patch a few files or add a few files. It depends on how the =evdev.xml= files get built

**** TODO determine whether this happens in xkbcomp, xkbcomp-intermediate or xkeyboard-config.

The layout/rules/etc files can be placed in various system directories.

+ they are bundled in =/usr/share/x11/...=
+ apparently can also be included in =/etc/x11/...=
+ whether the xorg-server from guix will be configured to recognize these directories is another question

** Pass as input to =xorg-server=


* Notes
** TODO make a proper XKB keyboard (properly translate hyper into input)

** Keycodes for modifiers

#+begin_quote
WHY YOU NO DOCUMENT MOD_LEVEL_8 mdoasmofd#@!*u$%)# @! %
#+end_quote

... [[https://github.com/xkbcommon/libxkbcommon/tree/master/doc][actually it's now fairly well documented]]


| ModLevel |     5 |     4 |    3 |    2 |    1 | Ctrl | ? | Shift  |
| Key      | AltGr | Super |      |      |  Alt | Ctrl |   | Shfit  |
| Value    |  0x80 |  0x40 | 0x20 | 0x10 | 0x08 | 0x04 |   | 0x0001 |

+ No =0x0F= modifier value?
+ What are:
  - Mod level 2?
  - Mod level 3?
  - Mod level 8?
+ Shift + Alt -> Meta
  - Keycodes: =0x01 + 0x08 == 0x09=
