:PROPERTIES:
:ID:       03114856-bd24-4f5b-b3bc-56d37a7059d2
:END:
#+TITLE: Number Theory: Exponentiated Lag Operators
#+CATEGORY: slips
#+TAGS:  
* Roam
+ [[id:a0ef7bfe-1587-4fec-ac87-f7dda5dc0d26][Maths: Number Theory]]

* Docs

* Resources

* Notes  

** Pascal's Triangle

This is found along the diagonals until the value wraps around

*** Pascal's Tetrahedron

You'd find this if using 3-dimensional matrices (tensors) with the appropriate
multiplication rules and/or transposition rules.

** Columns

+ d=3 :: Powers of two
+ d=4 :: Fibonacci
+ d=5 :: Recurrence of =3^((n/2) % 2)= and =2*3^((n/2) % 2)=

** Fibonacci
+ [[https://arxiv.org/abs/math/0403046][Fibonacci and Lucas Perfect Powers]] proves that the only perfect powers in
  fibonacci sequence are =[0,1,8,144]=
   - From Classical and Modular Approaches to Exponential Diophantine Equations

** Generating

With =d=4=

$\mathcal{L}\downarrow\left(d,1\right) = \mathcal{L}\uparrow\left(d,1\right)^{T}$

#+begin_src verse
[. . . .]
[1 . . .]
[. 1 . .]
[. . 1 .]
#+end_src

$\hat{\mathcal{L}}\downarrow\left(d,1\right)$

#+begin_src verse
[. . . 1]
[1 . . .]
[. 1 . .]
[. . 1 .]
#+end_src

$\mathcal{I}\uparrow\downarrow\left(d\right)$ := $\mathcal{L}\downarrow\left(d,1\right) + \mathcal{L}\downarrow\left(d,1\right)^{T}$ 

#+begin_src verse
[. 1 . .]
[1 . 1 .]
[. 1 . 1]
[. . 1 .]
#+end_src

$\mathcal{I}\downarrow\left(d\right)^{n}$ just exponentiates, either
left-associative or right-associative.

* Numpy

Deps

#+begin_src python
import itertools as it
import numpy as np
import polars as pl
from pprint import pprint

import math
import operator
import functools
import funcoperators as fc
from funcoperators import mapwith as Map
from funcoperators import mapwith as Filter
from funcoperators import compose
#+end_src

Series

#+begin_src python
def laghat(d):
  return np.roll(np.eye(d), shift=1, axis=0)

def lagmat(d):
  m = laghat(d)
  m[0,:] = 0
  return m

def imat(d,n):
  if n == 1: return lagmat(d) + lagmat(d).T
  return imat(d,n-1)@imat(d,1)

def ihat(d,n):
  if n == 1: return laghat(d) + laghat(d).T
  return ihat(d,n-1)@ihat(d,1)

def matpowers(mat, n, acc=[]):
  if n == 0: return [np.eye(*mat.shape)]
  series = matpowers(mat, n-1, acc)
  series = series + [mat@series[-1]]
  return series
#+end_src

Fibonacci, memoized to later produce fibonacci partitions for each value

+ I never got to this, but the idea would be to find the simplest fibonacci
  partition (the one using the least number of greatest factors)
+ Then generate a color sequence for fibonacci numbers where alternating colors
  are a sufficient distance apart. Then generate colors for each non-zero entry
  in a matrix using the simplest fibonacci sum for each, where the precedence is
  given to colors corresponding to the highest fibonacci values.
+ Thus, any algorithm to do so would benefit from being doubly dynamic
  - dynamic to memoize fibonacci
  - dynamic to memoize the fibonacci sums

#+begin_src python
def fibs(n): # arr=[]
  if n == 0: return 0 # return [0] + arr
  if n == 1: return 1 # return [1] + arr
  return fibs(n-2) + fibs(n-1)

# FIB_MEMO=[0,1,1];
def fib_memo(n):
  global FIB_MEMO
  if 3 > n: return FIB_MEMO[n]
  fn_1,fn_2 = (0,0)

  if len(FIB_MEMO) > n-2:
    fn_2 = FIB_MEMO[n-2]
  else:
    fn_2 = fib_memo(n-2)
    FIB_MEMO = FIB_MEMO + [fn_2]

  if len(FIB_MEMO) > n-1:
    fn_1 = FIB_MEMO[n-1]
  else:
    fn_1 = fib_memo(n-1)
    FIB_MEMO = FIB_MEMO + [fn_1]
  return fn_2 + fn_1
#+end_src

I started looking for powers of two in larger matrices. It'd be impossible for
powers of two to not show up, right? i have no proof that they would not... but
if for some reason they didn't (even for some rows/columns) that would be
profound.

#+begin_src python

f = compose(lambda arr: np.where((arr > 0.0), np.log2(arr), 0))

i3p = matpowers(i3,10); i3p2l = list(map(f, i3p));
i3p2l_int = list(map(lambda x: x.astype(int), i3p2l))

i4p = matpowers(i4,10); i4p2l = list(map(f, i4p));
i4p2l_int = list(map(lambda x: x.astype(int), i4p2l))

i6p = matpowers(i6,10); i6p2l = list(map(f, i6p));
i6p2l_int = list(map(lambda x: x.astype(int), i6p2l))

i7p = matpowers(i7,15); i7p2l = list(map(f, i7p));
i7p2l_int = list(map(lambda x: x.astype(int), i7p2l))

i8p = matpowers(i8,15); i8p2l = list(map(f, i8p));
i8p2l_int = list(map(lambda x: x.astype(int), i8p2l))
#+end_src

I would greatly prefer working with tensors there, but most tensor libraries are
really focused on regression/optimization, NOT the tensors. And this is where my
lack of experience with numpy really shows.

* Series

Copied out of jupyter/colab matrix output... then replaced strings to create
rectangular shape that would persist after =M-x rectangle-mark-mode=. Then insert
some =m= spaces so =C-u 8 C-n= jumps between tops of blocks.

Kind of a PITA, but otherwise, hard to interpret (esp without colors), so then
it's pointless to share.

It's entirely possible that this doesn't render correctly on Github (click view
code or raw) so I included the image at the bottom

#+begin_verse
      d=2     d=3         d=4             d=5                    d=6                        d=7
      
n=0   [1  ]   [1    ]     [1      ]       [1        ]            [1          ]              [1            ]                        
      [  1]   [  1  ]     [  1    ]       [  1      ]            [  1        ]              [  1          ]              
              [    1]     [    1  ]       [    1    ]            [    1      ]              [    1        ]              
                          [      1]       [      1  ]            [      1    ]              [      1      ]              
                                          [        1]            [        1  ]              [        1    ]                    
                                                                 [          1]              [          1  ]                    
                                                                                            [            1]                    
                                                                                                                               
n=1   [  1]   [  1  ]     [  1    ]       [  1      ]            [  1        ]              [  1          ]              
      [1  ]   [1   1]     [1   1  ]       [1   1    ]            [1   1      ]              [1   1        ]              
              [  1  ]     [  1   1]       [  1   1  ]            [  1   1    ]              [  1   1      ]              
                          [    1  ]       [    1   1]            [    1   1  ]              [    1   1    ]              
                                          [      1  ]            [      1   1]              [      1   1  ]              
                                                                 [        1  ]              [        1   1]              
                                                                                            [          1  ]              
                                                                                                                         
n=2   [1  ]   [1   1]     [1   1  ]       [1   1    ]            [1   1      ]              [1   1        ]              
      [  1]   [  2  ]     [  2   1]       [  2   1  ]            [  2   1    ]              [  2   1      ]              
              [1   1]     [1   2  ]       [1   2   1]            [1   2   1  ]              [1   2   1    ]              
                          [  1   1]       [  1   2  ]            [  1   2   1]              [  1   2   1  ]              
                                          [    1   1]            [    1   2  ]              [    1   2   1]              
                                                                 [      1   1]              [      1   2  ]              
                                                                                            [        1   1]              
                                                                                                                         
n=3   [  1]   [  2  ]     [  2   1]       [  2   1  ]            [  2   1    ]              [  2   1      ]              
      [1  ]   [2   2]     [2   3  ]       [2   3   1]            [2   3   1  ]              [2   3   1    ]              
              [  2  ]     [  3   2]       [  3   3  ]            [  3   3   1]              [  3   3   1  ]              
                          [1   2  ]       [1   3   2]            [1   3   3  ]              [1   3   3   1]              
                                          [  1   2  ]            [  1   3   2]              [  1   3   3  ]              
                                                                 [    1   2  ]              [    1   3   2]              
                                                                                            [      1   2  ]              
                                                                                                                         
n=4   [1  ]   [2   2]     [2   3  ]       [2   3   1]            [2   3   1  ]              [2   3   1    ]              
      [  1]   [  4  ]     [  5   3]       [  5   4  ]            [  5   4   1]              [  5   4   1  ]              
              [2   2]     [3   5  ]       [3   6   3]            [3   6   4  ]              [3   6   4   1]              
                          [  3   2]       [  4   5  ]            [  4   6   3]              [  4   6   4  ]              
                                          [1   3   2]            [1   4   5  ]              [1   4   6   3]              
                                                                 [  1   3   2]              [  1   4   5  ]              
                                                                                            [    1   3   2]              
                                                                                                                         
n=5   [  1]   [  4  ]     [  5   3]       [  5   4  ]            [    5     4     1]        [    5     4     1   ]           
      [1  ]   [4   4]     [5   8  ]       [5   9   4]            [ 5     9     5   ]        [ 5     9     5     1]       
              [  4  ]     [  8   5]       [  9   9  ]            [    9    10     4]        [    9    10     5   ]       
                          [3   5  ]       [4   9   5]            [ 4    10     9   ]        [ 4    10    10     4]       
                                          [  4   5  ]            [    5     9     5]        [    5    10     9   ]       
                                                                 [ 1     4     5   ]        [ 1     5     9     5]       
                                                                                            [    1     4     5   ]       
                                                                                                                         
n=6   [1  ]   [4   4]     [ 5     8   ]   [ 5     9     4]       [ 5     9     5   ]        [ 5     9     5     1]       
      [  1]   [  8  ]     [   13     8]   [   14    13   ]       [   14    14     5]        [   14    14     6   ]       
              [4   4]     [ 8    13   ]   [ 9    18     9]       [ 9    19    14   ]        [ 9    19    15     5]       
                          [    8     5]   [   13    14   ]       [   14    19     9]        [   14    20    14   ]       
                                          [ 4     9     5]       [ 5    14    14   ]        [ 5    15    19     9]       
                                                                 [    5     9     5]        [    6    14    14   ]       
                                                                                            [ 1     5     9     5]       
                                                                                                                         
n=7   [  1]   [  8  ]     [   13     8]   [   14    13   ]       [   14    14     5]        [   14    14     6   ]              
      [1  ]   [8   8]     [13    21   ]   [14    27    13]       [14    28    19   ]        [14    28    20     6]       
              [  8  ]     [   21    13]   [   27    27   ]       [   28    33    14]        [   28    34    20   ]       
                          [ 8    13   ]   [13    27    14]       [14    33    28   ]        [14    34    34    14]       
                                          [   13    14   ]       [   19    28    14]        [   20    34    28   ]       
                                                                 [ 5    14    14   ]        [ 6    20    28    14]       
                                                                                            [    6    14    14   ]       
                                                                                                                         
n=8   [1  ]   [ 8     8]  [13    21   ]   [14    27    13]       [14    28    19   ]        [14    28    20     6]       
      [  1]   [   16   ]  [   34    21]   [   41    40   ]       [   42    47    19]        [   42    48    26   ]       
              [ 8     8]  [21    34   ]   [27    54    27]       [28    61    47   ]        [28    62    54    20]       
                          [   21    13]   [   40    41   ]       [   47    61    28]        [   48    68    48   ]       
                                          [13    27    14]       [19    47    42   ]        [20    54    62    28]       
                                                                 [   19    28    14]        [   26    48    42   ]       
                                                                                            [ 6    20    28    14]       
                                                                                                                         
n=9   [  1]   [   16   ]  [   34    21]   [   41    40   ]       [     42      47      19]  [     42      48      26    ]
      [1  ]   [16    16]  [34    55   ]   [41    81    40]       [ 42      89      66    ]  [ 42      90      74      26]
              [   16   ]  [   55    34]   [   81    81   ]       [     89     108      47]  [     90     116      74    ]
                          [21    34   ]   [40    81    41]       [ 47     108      89    ]  [ 48     116     116      48]
                                          [   40    41   ]       [     66      89      42]  [     74     116      90    ]
                                                                 [ 19      47      42    ]  [ 26      74      90      42]
                                                                                            [     26      48      42    ]
                                                                                                                         
n=10  [1  ]   [16    16]  [34    55   ]   [ 41      81      40]  [ 42      89      66    ]  [ 42      90      74      26]                             
      [  1]   [   32   ]  [   89    55]   [    122     121    ]  [    131     155      66]  [    132     164     100    ]
              [16    16]  [55    89   ]   [ 81     162      81]  [ 89     197     155    ]  [ 90     206     190      74]
                          [   55    34]   [    121     122    ]  [    155     197      89]  [    164     232     164    ]
                                          [ 40      81      41]  [ 66     155     131    ]  [ 74     190     206      90]
                                                                 [     66      89      42]  [    100     164     132    ]
                                                                                            [ 26      74      90      42]
#+end_verse


** To highlight

#+begin_src emacs-lisp
;; pass to #'highlight-regexp
'( "\b1\b"  . menu 
   "\b2\b"  . citar 
   "\b3\b"  . hi-blue 
   "\b4\b"  . hi-yellow 
   "\b5\b"  . hi-pink 
   "\b6\b"  . hi-green 
   "\b7\b"  . hi-aquamarine 
   "\b8\b"  . hi-salmon  
   "\b13\b" . shr-h1 
   "\b16\b" . alert-high-face 
   "\b21\b" . shr-h3
   "\b34\b" . shr-h5
   "\b55\b" . shr-h6)
#+end_src


** Image



[[file:img/exponentiated-lag-matrices.png]]
